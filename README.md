Стрелка №1. (От user к chatadapter)

[chatadapter] [2025-02-18 21:05:14.123] Received message from user_id=123456, text="Привет"
Пояснения:
Компоненты: Пользователь (user) и chatadapter.
Тип запроса: Входящий текстовый запрос от пользователя.
Передаваемая информация:
user_id=123456 — идентификатор пользователя.
text="Привет" — отправленный текст.
Временная метка получения сообщения.
Роль компонента: chatadapter принимает сообщение от пользователя и начинает цепочку обработки, пересылая данные дальше в систему.

Стрелка №2. (От chatadapter к user)

[chatadapter] [2025-02-18 21:05:14.124] Sending typing indicator to user_id=123456
Пояснения:
Компоненты: chatadapter и пользователь (user).
Тип запроса: Служебное уведомление — индикатор "печатает".
Передаваемая информация:
Идентификатор пользователя (user_id=123456)
Статус: включённый индикатор, сигнализирующий о начале обработки.
Роль компонента: Этот шаг уведомляет пользователя о том, что его сообщение принято и обрабатывается, что улучшает пользовательский опыт.

Стрелка №3. (От chatadapter к botserver)

[botserver] [2025-02-18 21:05:14.125] Request from chatadapter: user_id=123456, text="Привет"
Пояснения:
Компоненты: chatadapter и botserver.
Тип запроса: Перенаправление входящего запроса на сервер бота.
Передаваемая информация:
user_id=123456 — тот же идентификатор пользователя.
text="Привет" — текст сообщения.
Роль компонента: chatadapter действует как курьер, передавая данные дальше в botserver, где происходит основная обработка запроса.

Стрелка №4. (От botserver к chatadapter)

[botserver] [2025-02-18 21:05:14.127] Acknowledged message reception from chatadapter. Status: 200 OK.
Пояснения:
Компоненты: botserver и chatadapter.
Тип запроса: Подтверждение приёма сообщения.
Передаваемая информация:
Статус обработки (например, 200 OK), что указывает на успешное получение запроса.
Роль компонента: botserver информирует chatadapter о том, что сообщение получено и обработка началась. Это помогает синхронизировать обмен данными между компонентами.

Стрелка №5. (От botserver к NLU)

[botserver] [2025-02-18 21:05:14.126] Calling NLU with text="Привет"
Пояснения:
Компоненты: botserver и NLU.
Тип запроса: Запрос к модулю анализа естественного языка (NLU) для распознавания интента.
Передаваемая информация:
text="Привет" — текст запроса, который будет проанализирован.
Роль компонента: botserver отправляет текст в NLU, чтобы получить информацию о намерении пользователя и вычленить сущности (если они есть).

Стрелка №6. (От NLU к botserver)

[NLU] [2025-02-18 21:05:14.131] Detected intent=Greeting, confidence=0.95
[NLU] [2025-02-18 21:05:14.131] Returning result to botserver: { "intent": "Greeting", "confidence": 0.95 }
Пояснения:
Компоненты: NLU и botserver.
Тип запроса: Ответ NLU с результатом анализа.
Передаваемая информация:
intent=Greeting — распознанный интент (приветствие).
confidence=0.95 — степень уверенности в распознавании.
Роль компонента: NLU анализирует текст и возвращает данные, позволяющие botserver понять, как дальше обрабатывать запрос.

Стрелка №7. (От botserver к chatadapter)

[botserver] [2025-02-18 21:05:14.133] Sending response "Привет! Предлагаю сыграть в игру 'Города'. Кто загадывает город?" to chatadapter
Пояснения:
Компоненты: botserver и chatadapter.
Тип запроса: Отправка сформированного ответа обратно в чат.
Передаваемая информация:
Текст ответа: "Привет! Предлагаю сыграть в игру 'Города'. Кто загадывает город?"
Роль компонента: botserver формирует ответ на основании результатов NLU и логики сценариев, после чего передаёт его в chatadapter.

Стрелка №8. (От chatadapter к user)

[chatadapter] [2025-02-18 21:05:14.135] Sending message to user_id=123456: "Привет! Предлагаю сыграть в игру 'Города'. Кто загадывает город?"
Пояснения:
Компоненты: chatadapter и пользователь (user).
Тип запроса: Исходящий текстовый ответ, доставляемый пользователю.
Передаваемая информация:
user_id=123456 — идентификатор получателя.
Текст сообщения — финальный ответ, который увидит пользователь.
Роль компонента: chatadapter завершает цикл обработки, отправляя готовый ответ пользователю через выбранный канал (например, Telegram или виджет).
